CREATE TABLE stories (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    content TEXT NOT NULL,
    image_url VARCHAR(255) NOT NULL,
    continent_id INT NOT NULL,
    subregion_id INT,
    storyteller_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW() ON UPDATE NOW(),
    CONSTRAINT fk_sub_region
        FOREIGN KEY (subregion_id) REFERENCES sub_regions(id)
        ON DELETE RESTRICT,
    CONSTRAINT fk_storyteller
        FOREIGN KEY (storyteller_id) REFERENCES storytellers(id)
        ON DELETE RESTRICT,
    CONSTRAINT fk_continent
        FOREIGN KEY (continent_id) REFERENCES continents(id)
        ON DELETE RESTRICT
);


CREATE TABLE continents (
  id INTEGER PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  description TEXT NOT NULL,
  population BIGINT UNSIGNED NOT NULL,
  area FLOAT UNSIGNED NOT NULL,
  image_url VARCHAR(255) NOT NULL 
);

CREATE TABLE storytellers (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(20) NOT NULL,
    last_name VARCHAR(20) NOT NULL,
    email VARCHAR(40) NOT NULL,
    password VARCHAR(20) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
); 
// ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

// regions
CREATE TABLE regions (
  id INT(11) NOT NULL AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  continent_id INT(11) NOT NULL,
  PRIMARY KEY (id),
  CONSTRAINT fk_regions_continent FOREIGN KEY (continent_id) REFERENCES continents(id)
)

// -- Legends table
CREATE TABLE legends (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    PRIMARY KEY (id)
) ENGINE=InnoDB;

// -- Association table between legends and regions
CREATE TABLE legend_region (
  legend_id INT(11) NOT NULL,
  region_id INT(11) NOT NULL,
  PRIMARY KEY (legend_id, region_id),
  FOREIGN KEY (legend_id) REFERENCES legends(id) ON DELETE CASCADE,
  FOREIGN KEY (region_id) REFERENCES regions(id) ON DELETE CASCADE
) ENGINE=InnoDB;

// #TODO new tables to create and add to database_schema.adoc

// story_ratings table
CREATE TABLE story_ratings (
    id INT PRIMARY KEY AUTO_INCREMENT,
    story_id INT NOT NULL,
    user_id INT NOT NULL,
    rating INT NOT NULL,
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    CONSTRAINT fk_story
        FOREIGN KEY (story_id) REFERENCES stories(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_user
        FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE CASCADE
);



// FOREIGN KEY (continent_id) REFERENCES continents(id),
//     FOREIGN KEY (subregion_id) REFERENCES subregions(id),
//     FOREIGN KEY (storyteller_id) REFERENCES storytellers(id)

